{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"/Users/tobias/Developer/digitalstage/ov-simulator/components/SoundCardSimulator.tsx\";\nimport { useCallback, useEffect, useRef, useState } from \"react\";\nimport { ClientDeviceEvents } from \"../utils/types/SocketEvents\";\nimport useStage from \"../libs/useStage\";\n\nconst AddSoundCardForm = () => {\n  const {\n    socket\n  } = useStage();\n  const nameRef = useRef();\n  const addSoundCard = useCallback(() => {\n    if (nameRef.current && socket) {\n      const name = nameRef.current.value;\n      const payload = {\n        initial: {\n          name: name,\n          driver: 'ALSA',\n          numInputChannels: 8,\n          numOutputChannels: 4,\n          sampleRate: 44100,\n          periodSize: 2,\n          numPeriods: 2\n        }\n      };\n      socket.emit(ClientDeviceEvents.ADD_SOUND_CARD, payload);\n    }\n  }, [socket, nameRef]);\n  return /*#__PURE__*/_jsxDEV(\"form\", {\n    children: [/*#__PURE__*/_jsxDEV(\"input\", {\n      type: \"name\",\n      ref: nameRef\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 33,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      type: \"submit\",\n      onClick: e => {\n        e.preventDefault();\n        addSoundCard();\n      },\n      children: \"ADD SOUNDCARD\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 34,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 32,\n    columnNumber: 9\n  }, this);\n};\n\nconst SoundCardSimulator = () => {\n  const {\n    device,\n    socket,\n    soundCards\n  } = useStage();\n  const {\n    0: connectedSoundCardIds,\n    1: setConnectedSoundCardIds\n  } = useState(device ? device.soundCardIds : []);\n  const updateConnectedSoundCardIds = useCallback(soundCardIds => {\n    if (socket && device) {\n      console.log(soundCardIds);\n      socket.emit(ClientDeviceEvents.UPDATE_DEVICE, {\n        _id: device._id,\n        soundCardIds: soundCardIds\n      });\n    }\n  }, [socket, device]);\n  useEffect(() => {\n    updateConnectedSoundCardIds(connectedSoundCardIds);\n  }, [connectedSoundCardIds]);\n  const removeSoundCard = useCallback(id => {\n    if (socket) {\n      socket.emit(ClientDeviceEvents.REMOVE_SOUND_CARD, id);\n    }\n  }, [socket]);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"p\", {\n      children: /*#__PURE__*/_jsxDEV(AddSoundCardForm, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 71,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n      children: soundCards.allIds.map(id => soundCards.byId[id]).map(soundCard => /*#__PURE__*/_jsxDEV(\"li\", {\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: soundCard._id,\n          children: soundCard.name\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 76,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          id: soundCard._id,\n          type: \"checkbox\",\n          onChange: e => {\n            if (e.currentTarget.checked) {\n              setConnectedSoundCardIds(prev => [...prev, soundCard._id]);\n            } else {\n              setConnectedSoundCardIds(prev => prev.filter(id => id !== soundCard._id));\n            }\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 77,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => removeSoundCard(soundCard._id),\n          children: \"DEL\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 88,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 75,\n        columnNumber: 21\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 73,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true);\n};\n\nexport default SoundCardSimulator;","map":{"version":3,"sources":["/Users/tobias/Developer/digitalstage/ov-simulator/components/SoundCardSimulator.tsx"],"names":["useCallback","useEffect","useRef","useState","ClientDeviceEvents","useStage","AddSoundCardForm","socket","nameRef","addSoundCard","current","name","value","payload","initial","driver","numInputChannels","numOutputChannels","sampleRate","periodSize","numPeriods","emit","ADD_SOUND_CARD","e","preventDefault","SoundCardSimulator","device","soundCards","connectedSoundCardIds","setConnectedSoundCardIds","soundCardIds","updateConnectedSoundCardIds","console","log","UPDATE_DEVICE","_id","removeSoundCard","id","REMOVE_SOUND_CARD","allIds","map","byId","soundCard","currentTarget","checked","prev","filter"],"mappings":"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","sourcesContent":["import {useCallback, useEffect, useRef, useState} from \"react\";\nimport ITeckosClient from \"teckos-client/dist/ITeckosClient\";\nimport {ClientDeviceEvents} from \"../utils/types/SocketEvents\";\nimport {Device} from \"../utils/types/Device\";\nimport {AddSoundCardPayload} from \"../utils/types/SocketPayloads\";\nimport {SoundCard} from \"../utils/types/SoundCard\";\nimport useStage from \"../libs/useStage\";\n\nconst AddSoundCardForm = () => {\n    const {socket} = useStage();\n    const nameRef = useRef<HTMLInputElement>();\n\n    const addSoundCard = useCallback(() => {\n        if (nameRef.current && socket) {\n            const name = nameRef.current.value;\n            const payload: AddSoundCardPayload = {\n                initial: {\n                    name: name,\n                    driver: 'ALSA',\n                    numInputChannels: 8,\n                    numOutputChannels: 4,\n                    sampleRate: 44100,\n                    periodSize: 2,\n                    numPeriods: 2\n                }\n            };\n            socket.emit(ClientDeviceEvents.ADD_SOUND_CARD, payload);\n        }\n    }, [socket, nameRef])\n\n    return (\n        <form>\n            <input type=\"name\" ref={nameRef}/>\n            <button type=\"submit\" onClick={(e) => {\n                e.preventDefault();\n                addSoundCard();\n            }}>\n                ADD SOUNDCARD\n            </button>\n        </form>\n    )\n};\n\nconst SoundCardSimulator = () => {\n    const {device, socket, soundCards} = useStage();\n    const [connectedSoundCardIds, setConnectedSoundCardIds] = useState<string[]>(device ? device.soundCardIds : []);\n\n    const updateConnectedSoundCardIds = useCallback((soundCardIds: string[]) => {\n        if (socket && device) {\n            console.log(soundCardIds);\n            socket.emit(ClientDeviceEvents.UPDATE_DEVICE, {\n                _id: device._id,\n                soundCardIds: soundCardIds\n            });\n        }\n    }, [socket, device]);\n\n    useEffect(() => {\n        updateConnectedSoundCardIds(connectedSoundCardIds);\n    }, [connectedSoundCardIds]);\n\n    const removeSoundCard = useCallback((id: string) => {\n        if (socket) {\n            socket.emit(ClientDeviceEvents.REMOVE_SOUND_CARD, id);\n        }\n    }, [socket])\n\n    return (\n        <>\n            <p>\n                <AddSoundCardForm/>\n            </p>\n            <ul>\n                {soundCards.allIds.map(id => soundCards.byId[id]).map(soundCard => (\n                    <li>\n                        <label htmlFor={soundCard._id}>{soundCard.name}</label>\n                        <input\n                            id={soundCard._id}\n                            type=\"checkbox\"\n                            onChange={e => {\n                                if (e.currentTarget.checked) {\n                                    setConnectedSoundCardIds(prev => [...prev, soundCard._id]);\n                                } else {\n                                    setConnectedSoundCardIds(prev => prev.filter(id => id !== soundCard._id));\n                                }\n                            }}\n                        />\n                        <button onClick={() => removeSoundCard(soundCard._id)}>\n                            DEL\n                        </button>\n                    </li>\n                ))}\n            </ul>\n        </>\n    )\n};\nexport default SoundCardSimulator;\n"]},"metadata":{},"sourceType":"module"}