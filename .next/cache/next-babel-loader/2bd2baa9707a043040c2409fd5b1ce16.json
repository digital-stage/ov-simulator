{"ast":null,"code":"import _toConsumableArray from \"/Users/tobias/Developer/digitalstage/ov-simulator/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"/Users/tobias/Developer/digitalstage/ov-simulator/components/SoundCardSimulator.tsx\",\n    _this = this,\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$();\n\nimport { useCallback, useEffect, useRef, useState } from \"react\";\nimport { ClientDeviceEvents } from \"../utils/types/SocketEvents\";\nimport useStage from \"../libs/useStage\";\n\nvar AddSoundCardForm = function AddSoundCardForm() {\n  _s();\n\n  var _useStage = useStage(),\n      socket = _useStage.socket;\n\n  var nameRef = useRef();\n  var numInputChannelsRef = useRef();\n  var numOutputChannelsRef = useRef();\n  var addSoundCard = useCallback(function () {\n    if (nameRef.current && numOutputChannelsRef.current && numInputChannelsRef.current && socket) {\n      var name = nameRef.current.value;\n      var numInputChannels = parseInt(numInputChannelsRef.current.value);\n      var numOutputChannels = parseInt(numOutputChannelsRef.current.value);\n      var payload = {\n        initial: {\n          name: name,\n          driver: 'ALSA',\n          numInputChannels: numInputChannels,\n          numOutputChannels: numOutputChannels,\n          sampleRate: 44100,\n          periodSize: 2,\n          numPeriods: 2\n        }\n      };\n      socket.emit(ClientDeviceEvents.ADD_SOUND_CARD, payload);\n    }\n  }, [socket, nameRef, numInputChannelsRef, numOutputChannelsRef]);\n  return /*#__PURE__*/_jsxDEV(\"form\", {\n    onSubmit: function onSubmit(e) {\n      e.preventDefault();\n      addSoundCard();\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"input\", {\n      type: \"name\",\n      ref: nameRef,\n      minLength: 1,\n      required: true\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 40,\n      columnNumber: 13\n    }, _this), /*#__PURE__*/_jsxDEV(\"input\", {\n      type: \"number\",\n      ref: numInputChannelsRef,\n      min: 0,\n      max: 8,\n      required: true\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 41,\n      columnNumber: 13\n    }, _this), /*#__PURE__*/_jsxDEV(\"input\", {\n      type: \"number\",\n      ref: numOutputChannelsRef,\n      min: 0,\n      max: 8,\n      required: true\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 42,\n      columnNumber: 13\n    }, _this), /*#__PURE__*/_jsxDEV(\"button\", {\n      type: \"submit\",\n      children: \"ADD SOUNDCARD\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 43,\n      columnNumber: 13\n    }, _this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 36,\n    columnNumber: 9\n  }, _this);\n};\n\n_s(AddSoundCardForm, \"HNlx7EY66nqpXfx7oTW39a/6uro=\", false, function () {\n  return [useStage];\n});\n\n_c = AddSoundCardForm;\n\nvar SoundCardSimulator = function SoundCardSimulator() {\n  _s2();\n\n  var _useStage2 = useStage(),\n      device = _useStage2.device,\n      socket = _useStage2.socket,\n      soundCards = _useStage2.soundCards;\n\n  var _useState = useState([]),\n      connectedSoundCardIds = _useState[0],\n      setConnectedSoundCardIds = _useState[1];\n\n  useEffect(function () {\n    if (device) {\n      setConnectedSoundCardIds(device.soundCardIds);\n    }\n  }, [device]);\n  var updateConnectedSoundCardIds = useCallback(function (soundCardIds) {\n    if (socket && device) {\n      console.log(soundCardIds);\n      socket.emit(ClientDeviceEvents.UPDATE_DEVICE, {\n        _id: device._id,\n        soundCardIds: soundCardIds\n      });\n    }\n  }, [socket, device]);\n  var removeSoundCard = useCallback(function (id) {\n    if (socket) {\n      socket.emit(ClientDeviceEvents.REMOVE_SOUND_CARD, id);\n    }\n  }, [socket]);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"p\", {\n      children: /*#__PURE__*/_jsxDEV(AddSoundCardForm, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 79,\n        columnNumber: 17\n      }, _this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 13\n    }, _this), /*#__PURE__*/_jsxDEV(\"ul\", {\n      children: soundCards.allIds.map(function (id) {\n        return soundCards.byId[id];\n      }).map(function (soundCard) {\n        return /*#__PURE__*/_jsxDEV(\"li\", {\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            htmlFor: soundCard._id,\n            children: soundCard.name\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 84,\n            columnNumber: 25\n          }, _this), /*#__PURE__*/_jsxDEV(\"input\", {\n            id: soundCard._id,\n            type: \"checkbox\",\n            checked: connectedSoundCardIds.indexOf(soundCard._id) !== -1,\n            onChange: function onChange(e) {\n              if (e.currentTarget.checked) {\n                updateConnectedSoundCardIds([].concat(_toConsumableArray(connectedSoundCardIds), [soundCard._id]));\n              } else {\n                updateConnectedSoundCardIds(connectedSoundCardIds.filter(function (id) {\n                  return id !== soundCard._id;\n                }));\n              }\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 85,\n            columnNumber: 25\n          }, _this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: function onClick() {\n              return removeSoundCard(soundCard._id);\n            },\n            children: \"DEL\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 97,\n            columnNumber: 25\n          }, _this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 83,\n          columnNumber: 21\n        }, _this);\n      })\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 13\n    }, _this)]\n  }, void 0, true);\n};\n\n_s2(SoundCardSimulator, \"uJoFmLl+UbzATnwPz3HEv+iOmmo=\", false, function () {\n  return [useStage];\n});\n\n_c2 = SoundCardSimulator;\nexport default SoundCardSimulator;\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"AddSoundCardForm\");\n$RefreshReg$(_c2, \"SoundCardSimulator\");","map":{"version":3,"sources":["/Users/tobias/Developer/digitalstage/ov-simulator/components/SoundCardSimulator.tsx"],"names":["useCallback","useEffect","useRef","useState","ClientDeviceEvents","useStage","AddSoundCardForm","socket","nameRef","numInputChannelsRef","numOutputChannelsRef","addSoundCard","current","name","value","numInputChannels","parseInt","numOutputChannels","payload","initial","driver","sampleRate","periodSize","numPeriods","emit","ADD_SOUND_CARD","e","preventDefault","SoundCardSimulator","device","soundCards","connectedSoundCardIds","setConnectedSoundCardIds","soundCardIds","updateConnectedSoundCardIds","console","log","UPDATE_DEVICE","_id","removeSoundCard","id","REMOVE_SOUND_CARD","allIds","map","byId","soundCard","indexOf","currentTarget","checked","filter"],"mappings":"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","sourcesContent":["import {useCallback, useEffect, useRef, useState} from \"react\";\nimport ITeckosClient from \"teckos-client/dist/ITeckosClient\";\nimport {ClientDeviceEvents} from \"../utils/types/SocketEvents\";\nimport {Device} from \"../utils/types/Device\";\nimport {AddSoundCardPayload} from \"../utils/types/SocketPayloads\";\nimport {SoundCard} from \"../utils/types/SoundCard\";\nimport useStage from \"../libs/useStage\";\n\nconst AddSoundCardForm = () => {\n    const {socket} = useStage();\n    const nameRef = useRef<HTMLInputElement>();\n    const numInputChannelsRef = useRef<HTMLInputElement>();\n    const numOutputChannelsRef = useRef<HTMLInputElement>();\n\n    const addSoundCard = useCallback(() => {\n        if (nameRef.current && numOutputChannelsRef.current && numInputChannelsRef.current && socket) {\n            const name = nameRef.current.value;\n            const numInputChannels = parseInt(numInputChannelsRef.current.value);\n            const numOutputChannels = parseInt(numOutputChannelsRef.current.value);\n            const payload: AddSoundCardPayload = {\n                initial: {\n                    name: name,\n                    driver: 'ALSA',\n                    numInputChannels,\n                    numOutputChannels,\n                    sampleRate: 44100,\n                    periodSize: 2,\n                    numPeriods: 2\n                }\n            };\n            socket.emit(ClientDeviceEvents.ADD_SOUND_CARD, payload);\n        }\n    }, [socket, nameRef, numInputChannelsRef, numOutputChannelsRef])\n\n    return (\n        <form onSubmit={(e) => {\n            e.preventDefault();\n            addSoundCard();\n        }}>\n            <input type=\"name\" ref={nameRef} minLength={1} required/>\n            <input type=\"number\" ref={numInputChannelsRef} min={0} max={8} required/>\n            <input type=\"number\" ref={numOutputChannelsRef} min={0} max={8} required/>\n            <button type=\"submit\">\n                ADD SOUNDCARD\n            </button>\n        </form>\n    )\n};\n\nconst SoundCardSimulator = () => {\n    const {device, socket, soundCards} = useStage();\n    const [connectedSoundCardIds, setConnectedSoundCardIds] = useState<string[]>([]);\n\n    useEffect(() => {\n        if (device) {\n            setConnectedSoundCardIds(device.soundCardIds);\n        }\n    }, [device]);\n\n    const updateConnectedSoundCardIds = useCallback((soundCardIds: string[]) => {\n        if (socket && device) {\n            console.log(soundCardIds);\n            socket.emit(ClientDeviceEvents.UPDATE_DEVICE, {\n                _id: device._id,\n                soundCardIds: soundCardIds\n            });\n        }\n    }, [socket, device]);\n\n    const removeSoundCard = useCallback((id: string) => {\n        if (socket) {\n            socket.emit(ClientDeviceEvents.REMOVE_SOUND_CARD, id);\n        }\n    }, [socket])\n\n    return (\n        <>\n            <p>\n                <AddSoundCardForm/>\n            </p>\n            <ul>\n                {soundCards.allIds.map(id => soundCards.byId[id]).map(soundCard => (\n                    <li>\n                        <label htmlFor={soundCard._id}>{soundCard.name}</label>\n                        <input\n                            id={soundCard._id}\n                            type=\"checkbox\"\n                            checked={connectedSoundCardIds.indexOf(soundCard._id) !== -1}\n                            onChange={e => {\n                                if (e.currentTarget.checked) {\n                                    updateConnectedSoundCardIds([...connectedSoundCardIds, soundCard._id]);\n                                } else {\n                                    updateConnectedSoundCardIds(connectedSoundCardIds.filter(id => id !== soundCard._id));\n                                }\n                            }}\n                        />\n                        <button onClick={() => removeSoundCard(soundCard._id)}>\n                            DEL\n                        </button>\n                    </li>\n                ))}\n            </ul>\n        </>\n    )\n};\nexport default SoundCardSimulator;\n"]},"metadata":{},"sourceType":"module"}